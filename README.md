# DID νλ¦„ κµ¬ν„ ν”„λ΅μ νΈ

μ΄ ν”„λ΅μ νΈλ” λ¶„μ‚° μ‹ μ› ν™•μΈ(DID) λ° κ²€μ¦ κ°€λ¥ν• μκ²© μ¦λ…(VC)μ κΈ°λ³Έμ μΈ νλ¦„μ„ ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ μ•„ν‚¤ν…μ² κ΄€μ μ—μ„ λ³΄μ—¬μ¤λ‹λ‹¤. Veramo ν”„λ μ„μ›ν¬λ¥Ό μ‚¬μ©ν• κµ¬ν„κ³Ό, Veramo κ°™μ€ κ³ μμ¤€ ν”„λ μ„μ›ν¬ μ—†μ΄ DIDμ μ›λ¦¬λ¥Ό μ§μ ‘ κµ¬ν„ν•λ” `vanila-web` μμ λ¥Ό λ¨λ‘ μ κ³µν•©λ‹λ‹¤.

## νλ¦„ κ°μ”

1.  **DID μ—μ΄μ „νΈ/λ΅μ§ μ„¤μ •**: ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°κ° DID κ΄€λ ¨ λ΅μ§μ„ μ„¤μ •ν•©λ‹λ‹¤.
2.  **DID μƒμ„±**: μ„λ²„λ” λ°κΈ‰μ(issuer) DIDλ¥Ό μƒμ„±ν•κ³ , ν΄λΌμ΄μ–ΈνΈλ” λ³΄μ μ(holder) DIDλ¥Ό μƒμ„±ν•©λ‹λ‹¤. (κ° DID λ©”μ†λ“μ— λ”°λΌ `did:key` λλ” `did:web` μ‚¬μ©)
3.  **κ²€μ¦ κ°€λ¥ν• μκ²© μ¦λ…(VC) λ°κΈ‰**: ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μμ‹ μ DIDλ¥Ό λ³΄λ‚΄ VCλ¥Ό μ”μ²­ν•κ³ , μ„λ²„λ” VCλ¥Ό λ°κΈ‰ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅ν•©λ‹λ‹¤.
4.  **κ²€μ¦ κ°€λ¥ν• ν”„λ μ  ν…μ΄μ…(VP) μƒμ„±**: ν΄λΌμ΄μ–ΈνΈλ” μμ‹ ν• VCλ¥Ό μ‚¬μ©ν•μ—¬ VPλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
5.  **VP κ²€μ¦**: ν΄λΌμ΄μ–ΈνΈλ” μƒμ„±λ VPλ¥Ό μ„λ²„λ΅ μ „μ†΅ν•κ³ , μ„λ²„λ” VPλ¥Ό κ²€μ¦ν•μ—¬ κ²°κ³Όλ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² λ°ν™ν•©λ‹λ‹¤.

## μ„¤μΉ

ν”„λ΅μ νΈλ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄ λ¨Όμ € λ‹¤μ μΆ…μ†μ„±μ„ μ„¤μΉν•΄μ•Ό ν•©λ‹λ‹¤.

```bash
npm install
```

---

## Veramoλ¥Ό μ΄μ©ν• DID νλ¦„ (`key/`, `web/` λ””λ ‰ν† λ¦¬)

μ΄ μ„Ήμ…μ€ Veramo ν”„λ μ„μ›ν¬λ¥Ό μ‚¬μ©ν•μ—¬ DID νλ¦„μ„ κµ¬ν„ν•λ” λ°©λ²•μ„ λ³΄μ—¬μ¤λ‹λ‹¤.

### `did:key` ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ μ•„ν‚¤ν…μ² μ‹¤ν–‰

`did:key` λ©”μ†λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ΅μ»¬μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ DID νλ¦„μ„ μ‹μ—°ν•©λ‹λ‹¤.

1.  **μ„λ²„ μ‹μ‘**: μƒ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

    ```bash
    node key/server.js
    ```

    μ„λ²„λ” Issuer DIDλ¥Ό μ¶λ ¥ν•κ³  3000λ² ν¬νΈμ—μ„ μμ‹  λ€κΈ°ν•©λ‹λ‹¤.

2.  **ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰**: λ‹¤λ¥Έ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    ```bash
    node key/client.js
    ```

    ν΄λΌμ΄μ–ΈνΈλ” λ‹¤μμ„ μν–‰ν•©λ‹λ‹¤:
    *   Holder DIDλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
    *   μ„λ²„μ— μκ²© μ¦λ…μ„ μ”μ²­ν•©λ‹λ‹¤.
    *   μ„λ²„λ΅λ¶€ν„° λ°›μ€ μκ²© μ¦λ…μΌλ΅ ν”„λ μ  ν…μ΄μ…μ„ μƒμ„±ν•©λ‹λ‹¤.
    *   μƒμ„±λ ν”„λ μ  ν…μ΄μ…μ„ μ„λ²„μ— λ³΄λ‚΄ κ²€μ¦μ„ μ”μ²­ν•©λ‹λ‹¤.
    *   μ„λ²„λ΅λ¶€ν„° λ°›μ€ κ²€μ¦ κ²°κ³Όλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

### `did:web` ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ μ•„ν‚¤ν…μ² μ‹¤ν–‰ (λ΅μ»¬ μ‹λ®¬λ μ΄μ…)

`did:web` λ©”μ†λ“λ¥Ό μ‚¬μ©ν•μ—¬ λ΅μ»¬μ—μ„ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ DID νλ¦„μ„ μ‹μ—°ν•©λ‹λ‹¤. `did:web`μ€ μΌλ°μ μΌλ΅ κ³µκ°μ μΌλ΅ μ ‘κ·Ό κ°€λ¥ν• μ›Ή μ„λ²„λ¥Ό ν•„μ”λ΅ ν•μ§€λ§, μ΄ μμ μ—μ„λ” λ΅μ»¬μ—μ„ μ΄λ¥Ό μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤.

**μ£Όμ**: `did:web`μ€ μ‹¤μ  ν™κ²½μ—μ„ λ™μ‘ν•λ ¤λ©΄ κ³µκ°μ μΌλ΅ μ ‘κ·Ό κ°€λ¥ν• λ„λ©”μΈκ³Ό ν•΄λ‹Ή λ„λ©”μΈμ— νΈμ¤ν…λλ” `.well-known/did.json` νμΌμ΄ ν•„μ”ν•©λ‹λ‹¤. μ΄ μμ λ” λ΅μ»¬ κ°λ° ν™κ²½μ—μ„μ μ‹μ—°μ„ μ„ν• κ²ƒμ…λ‹λ‹¤.

1.  **μ„λ²„ μ‹μ‘**: μƒ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

    ```bash
    node web/server.js
    ```

    μ„λ²„λ” `did:web:localhost:3000` DIDλ¥Ό Issuer DIDλ΅ μ‚¬μ©ν•λ©°, `http://localhost:3000/.well-known/did.json` κ²½λ΅μ—μ„ μμ²΄ DID λ¬Έμ„λ¥Ό μ κ³µν•©λ‹λ‹¤.

2.  **ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰**: λ‹¤λ¥Έ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    ```bash
    node web/client.js
    ```

    ν΄λΌμ΄μ–ΈνΈλ” λ‹¤μμ„ μν–‰ν•©λ‹λ‹¤:
    *   Holder DIDλ¥Ό μƒμ„±ν•©λ‹λ‹¤. (μ—¬κΈ°μ„λ” `did:key`λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤. `did:web` ν™€λ”λ¥Ό κµ¬ν„ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈλ„ DID λ¬Έμ„λ¥Ό νΈμ¤ν…ν•΄μ•Ό ν•λ―€λ΅ λ³µμ΅μ„±μ΄ μ¦κ°€ν•©λ‹λ‹¤.)
    *   μ„λ²„μ— μκ²© μ¦λ…μ„ μ”μ²­ν•©λ‹λ‹¤.
    *   μ„λ²„λ΅λ¶€ν„° λ°›μ€ μκ²© μ¦λ…μΌλ΅ ν”„λ μ  ν…μ΄μ…μ„ μƒμ„±ν•©λ‹λ‹¤.
    *   μƒμ„±λ ν”„λ μ  ν…μ΄μ…μ„ μ„λ²„μ— λ³΄λ‚΄ κ²€μ¦μ„ μ”μ²­ν•©λ‹λ‹¤.
    *   μ„λ²„λ΅λ¶€ν„° λ°›μ€ κ²€μ¦ κ²°κ³Όλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

---

## Veramo μ—†μ΄ DID νλ¦„ κµ¬ν„ (`vanila-web/` λ””λ ‰ν† λ¦¬)

μ΄ μ„Ήμ…μ€ Veramoμ™€ κ°™μ€ κ³ μμ¤€ ν”„λ μ„μ›ν¬ μ—†μ΄, `did-jwt-vc`, `did-resolver` λ“±μ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ DID νλ¦„μ μ›λ¦¬λ¥Ό μ§μ ‘ κµ¬ν„ν•κ³  μ΄ν•΄ν•λ” λ° μ¤‘μ μ„ λ‘΅λ‹λ‹¤.

*   `server.js`: `did:web` λ°κΈ‰μ(Issuer) μ—­ν• μ„ ν•©λ‹λ‹¤.
*   `client.js`: `did:key` λ³΄μ μ(Holder) μ—­ν• μ„ ν•©λ‹λ‹¤.
*   `external-verifier.js`: `did-resolver`λ¥Ό μ‚¬μ©ν•κ±°λ‚ `/.well-known/did.json`μ„ μ§μ ‘ νΈμ¶ν•μ—¬, `did:web` DID λ¬Έμ„ ν•΄μ„ κ³Όμ •μ„ λ…μ‹μ μΌλ΅ λ³΄μ—¬μ£Όλ” μ™Έλ¶€ κ²€μ¦κΈ° μ—­ν• μ„ ν•©λ‹λ‹¤.

### 1. `vanila-web` ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ κΈ°λ³Έ νλ¦„ μ‹¤ν–‰

`did-jwt-vc` λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ VC/VPλ¥Ό μƒμ„±ν•κ³  κ²€μ¦ν•λ” κΈ°λ³Έ νλ¦„μ„ μ‹μ—°ν•©λ‹λ‹¤.

1.  **μ„λ²„ μ‹μ‘**: μƒ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ `vanila-web` μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

    ```bash
    node vanila-web/server.js
    ```

    μ„λ²„λ” `did:web:localhost:4000`μ„ Issuer DIDλ΅ μ‚¬μ©ν•λ©°, `http://localhost:4000/.well-known/did.json` κ²½λ΅μ—μ„ μμ²΄ DID λ¬Έμ„λ¥Ό μ κ³µν•©λ‹λ‹¤.

2.  **ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰**: λ‹¤λ¥Έ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ `vanila-web` ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    ```bash
    node vanila-web/client.js
    ```

    ν΄λΌμ΄μ–ΈνΈλ” λ‹¤μμ„ μν–‰ν•©λ‹λ‹¤:
    *   Holder `did:key`λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
    *   μ„λ²„μ— VCλ¥Ό μ”μ²­ν•©λ‹λ‹¤.
    *   μμ‹ ν• VCλ΅ VPλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
    *   μƒμ„±λ VPλ¥Ό μ„λ²„μ— λ³΄λ‚΄ κ²€μ¦μ„ μ”μ²­ν•κ³ , κ²°κ³Όλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

### 2. `did:web` μ™Έλ¶€ κ²€μ¦κΈ° μ‹μ—° (`external-verifier.js`)

`/.well-known/did.json`μ΄ μ™Έλ¶€ μ‹μ¤ν…μ— μν•΄ μ–΄λ–»κ² νΈμ¶λκ³  ν™μ©λλ”μ§€ λ…μ‹μ μΌλ΅ λ³΄μ—¬μ¤λ‹λ‹¤.

1.  **μ„λ²„ μ‹μ‘**: μƒ ν„°λ―Έλ„μ„ μ—΄κ³  `vanila-web` μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤. (μ„ "κΈ°λ³Έ νλ¦„ μ‹¤ν–‰"κ³Ό λ™μΌ)

    ```bash
    node vanila-web/server.js
    ```

2.  **μ™Έλ¶€ κ²€μ¦κΈ° μ‹¤ν–‰**: λ‹¤λ¥Έ ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ μ™Έλ¶€ κ²€μ¦κΈ°λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    ```bash
    node vanila-web/external-verifier.js
    ```

    μ™Έλ¶€ κ²€μ¦κΈ°λ” λ‹¤μμ„ μν–‰ν•©λ‹λ‹¤:
    *   μμ²΄μ μΌλ΅ Holder `did:key`λ¥Ό μƒμ„±ν•κ³  μ„λ²„μ— VCλ¥Ό μ”μ²­ν•μ—¬ VPλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
    *   VPλ¥Ό κ²€μ¦ν•λ” κ³Όμ •μ—μ„, `did:web` λ°κΈ‰μμ DID λ¬Έμ„λ¥Ό κ°€μ Έμ¤κΈ° μ„ν•΄ **`http://localhost:4000/.well-known/did.json` μ—”λ“ν¬μΈνΈμ— μ§μ ‘ HTTP μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.** (μ„λ²„ ν„°λ―Έλ„μ— μ΄ νΈμ¶ λ΅κ·Έκ°€ μ¶λ ¥λ  κ²ƒμ…λ‹λ‹¤.)
    *   κ°€μ Έμ¨ DID λ¬Έμ„μ κ³µκ°ν‚¤λ΅ VCμ μ„λ…μ„ κ²€μ¦ν•κ³ , μµμΆ… κ²°κ³Όλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

---

## DID νλ¦„ κµ¬ν„ (μ¨μ²΄μΈ μƒνΈμ‘μ© - `ethr-flow/` λ””λ ‰ν† λ¦¬)

μ΄ μ„Ήμ…μ€ μ‹¤μ  μ΄λ”λ¦¬μ›€ ν…μ¤νΈλ„·(Sepolia)κ³Όμ μ¨μ²΄μΈ μƒνΈμ‘μ©μ„ ν¬ν•¨ν•λ” `did:ethr` νλ¦„μ„ λ³΄μ—¬μ¤λ‹λ‹¤. `did:ethr`μ€ μ΄λ”λ¦¬μ›€ μ£Όμ† κΈ°λ°μ DIDμ΄λ©°, DIDμ μ†μ κ¶ λ° μ†μ„± κ΄€λ¦¬λ” μ΄λ”λ¦¬μ›€ λΈ”λ΅μ²΄μΈ μƒμ DID λ μ§€μ¤νΈλ¦¬ μ»¨νΈλ™νΈλ¥Ό ν†µν•΄ μ΄λ£¨μ–΄μ§‘λ‹λ‹¤.

**μ£Όμ**: μ΄ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•λ ¤λ©΄ λ‹¤μ μ¤€λΉ„λ¬Όμ΄ ν•„μ”ν•©λ‹λ‹¤.

*   **Infura Project ID**: Sepolia ν…μ¤νΈλ„·μ— μ—°κ²°ν•κΈ° μ„ν• Infura Project IDκ°€ ν•„μ”ν•©λ‹λ‹¤. `ethr-flow/agent.js` νμΌ λ‚΄μ `INFURA_PROJECT_ID` λ³€μλ¥Ό μμ‹ μ Infura Project IDλ΅ κµμ²΄ν•΄μ•Ό ν•©λ‹λ‹¤.
*   **Sepolia ETH**: `issuerPrivKey`μ— ν•΄λ‹Ήν•λ” μ΄λ”λ¦¬μ›€ μ£Όμ†μ— νΈλμ­μ… μμλ£(gas fee)λ¥Ό μ§€λ¶ν•  Sepolia ETHκ°€ μ¶©λ¶„ν μμ–΄μ•Ό ν•©λ‹λ‹¤. Sepolia Faucet(μ: `https://sepoliafaucet.com/`)μ—μ„ ν…μ¤νΈ ETHλ¥Ό μ–»μ„ μ μμµλ‹λ‹¤.

### `did:ethr` νλ¦„ μ‹¤ν–‰ (Sepolia ν…μ¤νΈλ„·)

1.  **Infura Project ID μ„¤μ •**: `ethr-flow/agent.js` νμΌμ„ μ—΄κ³ , `INFURA_PROJECT_ID` λ³€μλ¥Ό μμ‹ μ κ°’μΌλ΅ κµμ²΄ν•©λ‹λ‹¤.

    ```javascript
    const INFURA_PROJECT_ID = 'YOUR_INFURA_PROJECT_ID'; // <-- μμ‹ μ Infura Project IDλ΅ κµμ²΄
    ```

2.  **ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰**: ν„°λ―Έλ„μ„ μ—΄κ³  λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤.

    ```bash
    node ethr-flow/agent.js
    ```

    μ¤ν¬λ¦½νΈλ” λ‹¤μμ„ μν–‰ν•©λ‹λ‹¤:
    *   `issuerPrivKey`λ΅λ¶€ν„° λ°κΈ‰μ(Issuer) DIDλ¥Ό κ²°μ •ν•©λ‹λ‹¤.
    *   Sepolia ν…μ¤νΈλ„·μ— λ°°ν¬λ κ³µμ‹ `ethr-did-registry` μ»¨νΈλ™νΈλ¥Ό ν†µν•΄ ν•΄λ‹Ή DIDμ μ†μ κ¶μ„ ν™•μΈν•κ³ , λ“±λ΅λμ§€ μ•μ•λ‹¤λ©΄ λ“±λ΅ νΈλμ­μ…μ„ μ „μ†΅ν•©λ‹λ‹¤.
    *   κ²€μ¦ κ°€λ¥ν• μκ²© μ¦λ…(VC)μ„ μƒμ„±ν•©λ‹λ‹¤.
    *   μƒμ„±λ VCλ¥Ό ν¬ν•¨ν•λ” κ²€μ¦ κ°€λ¥ν• ν”„λ μ  ν…μ΄μ…(VP)μ„ μƒμ„±ν•©λ‹λ‹¤.
    *   μƒμ„±λ VPλ¥Ό κ²€μ¦ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό μ¶λ ¥ν•©λ‹λ‹¤.

    **μμƒ μ¶λ ¥**: λ¨λ“  λ‹¨κ³„κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λλ©΄ "β… VP Verification Successful!" λ©”μ‹μ§€μ™€ ν•¨κ» κ²€μ¦λ μκ²© μ¦λ… λ°μ΄ν„°κ°€ μ¶λ ¥λ©λ‹λ‹¤. DID λ“±λ΅μ€ μ΄λ―Έ λ“±λ΅λ κ²½μ° κ±΄λ„λ›Έ μ μμµλ‹λ‹¤.

---

## μμƒ μ¶λ ¥

λ¨λ“  `client.js` λ° `external-verifier.js` μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•λ©΄ κ° ν„°λ―Έλ„μ— μƒμ„Έν• κ³Όμ •κ³Ό ν•¨κ» μµμΆ… `verified: true` κ²°κ³Όκ°€ μ¶λ ¥λμ–΄ μ„±κ³µμ μΈ DID νλ¦„μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
`external-verifier.js` μ‹¤ν–‰ μ‹ μ„λ²„ ν„°λ―Έλ„μ— `π”µ (μ™Έλ¶€ μ”μ²­) /.well-known/did.json μ—”λ“ν¬μΈνΈκ°€ νΈμ¶λμ—μµλ‹λ‹¤!` λ΅κ·Έκ°€ μ¶λ ¥λλ” κ²ƒμ„ ν™•μΈν•΄μ•Ό ν•©λ‹λ‹¤.